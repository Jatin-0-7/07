<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Live Player</title>
  <script src="https://cdn.jsdelivr.net/npm/shaka-player@4.3.5/dist/shaka-player.compiled.min.js"></script>
  <style>
    body {
      margin: 0;
      background: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    video {
      width: 90%;
      max-width: 960px;
      border: 3px solid #00eaff;
      border-radius: 12px;
      box-shadow: 0 0 15px #00eaff88;
    }
  </style>
</head>
<body>
<video id="video" autoplay muted controls></video>

<script>
  const urlParams = new URLSearchParams(window.location.search);
  const manifestUri = urlParams.get("mpd");
  const keyId = urlParams.get("keyId");
  const key = urlParams.get("key");

  async function initPlayer() {
    shaka.polyfill.installAll();

    if (!shaka.Player.isBrowserSupported()) {
      alert("Browser not supported!");
      return;
    }

    const video = document.getElementById("video");
    const player = new shaka.Player(video);

    player.configure({
      drm: {
        clearKeys: {
          [keyId]: key
        }
      }
    });

    try {
      await player.load(manifestUri);
      console.log("Stream loaded!");
    } catch (err) {
      console.error("Error loading video:", err);
    }
  }

  document.addEventListener("DOMContentLoaded", initPlayer);
</script>

</body>
</html>
